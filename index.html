<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chibeki Bot</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            font-family: 'Montserrat', sans-serif;
            overflow: hidden;
            position: relative;
            background-color: #000;
        }

        .onboarding-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000;
            display: flex;
            flex-direction: column;
            z-index: 20;
            padding: 20px;
            box-sizing: border-box;
            color: white;
        }

        .progress-bars {
            display: flex;
            gap: 5px;
            margin-bottom: 40px;
        }

        .progress-bar-container {
            flex: 1;
            height: 3px;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            width: 0%;
            background-color: white;
            border-radius: 2px;
            transition: none;
        }

        .slide-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
        }

        .slide {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
        }

        .slide.active {
            display: flex;
        }

        .slide-gif {
            width: 200px;
            height: 200px;
            margin-bottom: 30px;
        }

        .slide-title {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .slide-description {
            font-size: 15px;
            opacity: 0.9;
            line-height: 1.5;
            max-width: 320px;
            margin-bottom: 20px;
        }

        .hidden {
            display: none !important;
        }

        .click-area {
            position: absolute;
            top: 0;
            width: 50%;
            height: 100%;
            z-index: 5;
        }

        .click-area.left {
            left: 0;
        }

        .click-area.right {
            right: 0;
        }

        .tg-button-area {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            padding: 0 20px;
        }
    </style>
</head>
<body>
    <div class="onboarding-screen" id="onboardingScreen">
        <div class="progress-bars">
            <div class="progress-bar-container">
                <div class="progress-bar-fill" id="progressBar1"></div>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar-fill" id="progressBar2"></div>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar-fill" id="progressBar3"></div>
            </div>
        </div>
        
        <div class="slide-content">
            <div class="click-area left" id="leftArea"></div>
            <div class="click-area right" id="rightArea"></div>
            
            <div class="slide active" id="slide1">
                <img src="https://media.tenor.com/xrqG4GhZxZcAAAAi/utya-telegram.gif" alt="Добро пожаловать" class="slide-gif">
                <div class="slide-title">Добро пожаловать!</div>
                <div class="slide-description">Это приложение разработано специально для более удобного использования бота! Здесь тебя ждут все нужные статьи, гайды, и даже можно смотреть своих чибиков, прикинь? Советую не медлить, гуд лак!</div>
            </div>
            
            <div class="slide" id="slide2">
                <img src="https://media.tenor.com/LO1LW4khBigAAAAi/utya-utya-duck.gif" alt="Любишь чибиков?" class="slide-gif">
                <div class="slide-title">Любишь чибиков?</div>
                <div class="slide-description">Держу пари что да, иначе бы ты сейчас здесь не находился! Если у тебя есть предложения для развития бота или идеи для новых чибиков, мы всегда рады! Ты можешь связаться с нами, и тебе по-быстрому ответят! Если есть вопросы, идеи или еще что-то, мы всегда открыты к диалогу! Ждем тебя у нас, и спасибо что играешь в ЧИБИКОВ!</div>
                <div class="tg-button-area" id="contactButtonArea"></div>
            </div>
            
            <div class="slide" id="slide3">
                <img src="https://media.tenor.com/tTbGahmBaxkAAAAi/utya.gif" alt="У нас есть канал!" class="slide-gif">
                <div class="slide-title">У нас есть канал!</div>
                <div class="slide-description">Кстати, у чибиков есть свой собственный телеграм-канал! Залетай быстрее и подписывайся, ведь там мы проводим розыгрыши на уникальные призы, общаемся с вами и делимся процессом создания чибиков! Спасибо за подписку, друг!</div>
                <div class="tg-button-area" id="channelButtonArea"></div>
            </div>
        </div>
    </div>

    <script>
        const onboardingScreen = document.getElementById('onboardingScreen');
        const progressBar1 = document.getElementById('progressBar1');
        const progressBar2 = document.getElementById('progressBar2');
        const progressBar3 = document.getElementById('progressBar3');
        const slide1 = document.getElementById('slide1');
        const slide2 = document.getElementById('slide2');
        const slide3 = document.getElementById('slide3');
        const leftArea = document.getElementById('leftArea');
        const rightArea = document.getElementById('rightArea');
        const channelButtonArea = document.getElementById('channelButtonArea');
        const contactButtonArea = document.getElementById('contactButtonArea');
        
        let currentSlide = 1;
        let currentTimer = null;
        
        function vibrate() {
            if (window.Telegram && window.Telegram.WebApp && Telegram.WebApp.HapticFeedback) {
                Telegram.WebApp.HapticFeedback.impactOccurred('light');
            }
        }
        
        function shouldShowOnboarding() {
            return true;
        }
        
        function saveLaunchTime() {
            localStorage.setItem('lastLaunchTime', Date.now().toString());
        }
        
        function clearCurrentTimer() {
            if (currentTimer) {
                clearTimeout(currentTimer);
                currentTimer = null;
            }
        }
        
        function resetProgressBars() {
            // Моментальный сброс без анимации
            progressBar1.style.transition = 'none';
            progressBar2.style.transition = 'none';
            progressBar3.style.transition = 'none';
            
            progressBar1.style.width = '0%';
            progressBar2.style.width = '0%';
            progressBar3.style.width = '0%';
            
            // Возвращаем анимацию только для активного прогресс-бара
            setTimeout(() => {
                progressBar1.style.transition = 'width 10s linear';
                progressBar2.style.transition = 'width 10s linear';
                progressBar3.style.transition = 'width 10s linear';
            }, 10);
        }
        
        function showSlide(slideNumber) {
            vibrate();
            clearCurrentTimer();
            resetProgressBars();
            
            // Скрываем все слайды
            slide1.classList.remove('active');
            slide2.classList.remove('active');
            slide3.classList.remove('active');
            
            // Убираем кнопки Telegram
            removeTelegramButtons();
            
            // Показываем нужный слайд и запускаем только его прогресс-бар
            if (slideNumber === 1) {
                slide1.classList.add('active');
                currentSlide = 1;
                setTimeout(() => {
                    progressBar1.style.width = '100%';
                }, 10);
                currentTimer = setTimeout(() => showSlide(2), 10000);
            } 
            else if (slideNumber === 2) {
                slide2.classList.add('active');
                currentSlide = 2;
                setTimeout(() => {
                    progressBar2.style.width = '100%';
                }, 10);
                createTelegramButton(contactButtonArea, 'Написать нам', 'https://t.me/request_chibeki_bot');
                currentTimer = setTimeout(() => showSlide(3), 10000);
            } 
            else if (slideNumber === 3) {
                slide3.classList.add('active');
                currentSlide = 3;
                setTimeout(() => {
                    progressBar3.style.width = '100%';
                }, 10);
                createTelegramButton(channelButtonArea, 'Перейти', 'https://t.me/chibeki_official');
                currentTimer = setTimeout(finishOnboarding, 10000);
            }
        }
        
        function createTelegramButton(container, text, url) {
            if (window.Telegram && window.Telegram.WebApp) {
                const button = Telegram.WebApp.MainButton;
                button.setText(text);
                button.show();
                
                // Желтый цвет как акцентный
                button.setParams({
                    color: '#FFD951',
                    text_color: '#000000'
                });
                
                const clickHandler = function() {
                    Telegram.WebApp.openTelegramLink(url);
                };
                
                button.onClick(clickHandler);
                container._clickHandler = clickHandler;
            }
        }
        
        function removeTelegramButtons() {
            if (window.Telegram && window.Telegram.WebApp) {
                Telegram.WebApp.MainButton.hide();
                Telegram.WebApp.MainButton.offClick(contactButtonArea._clickHandler);
                Telegram.WebApp.MainButton.offClick(channelButtonArea._clickHandler);
            }
        }
        
        function previousSlide() {
            if (currentSlide === 1) {
                showSlide(1);
            } else {
                showSlide(currentSlide - 1);
            }
        }
        
        function nextSlide() {
            if (currentSlide === 3) {
                finishOnboarding();
            } else {
                showSlide(currentSlide + 1);
            }
        }
        
        function finishOnboarding() {
            removeTelegramButtons();
            saveLaunchTime();
            onboardingScreen.style.opacity = '0';
            
            setTimeout(() => {
                onboardingScreen.style.display = 'none';
            }, 500);
        }
        
        function initTelegramWebApp() {
            if (window.Telegram && window.Telegram.WebApp) {
                Telegram.WebApp.ready();
                Telegram.WebApp.expand();
            }
        }
        
        leftArea.addEventListener('click', previousSlide);
        rightArea.addEventListener('click', nextSlide);
        
        window.onload = function() {
            initTelegramWebApp();
            
            if (shouldShowOnboarding()) {
                showSlide(1);
            } else {
                onboardingScreen.style.display = 'none';
            }
        };
    </script>
</body>
</html>
